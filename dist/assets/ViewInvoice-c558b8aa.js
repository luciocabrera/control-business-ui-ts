import{k as A,j as a,b as p,F as y,o as P,Y as C,L as K,D as S,X as h,K as k,A as b,g as N,Q as V}from"./index-a0b9f4a7.js";import{d as W,I as j}from"./InvoiceDetailsField-07452ad4.js";import{r as o,u as Q,d as R}from"./vendor-2ae8ef6f.js";import{R as G}from"./ReadOnlyTable-45e8a839.js";import{P as L}from"./PageSpinner-9a0c75ea.js";import"./swr-04965976.js";import{F as M,I as H}from"./Form-41bf580f.js";import"./styled-components-e6489abd.js";import"./use-context-selector-6b0b0676.js";import"./CopyIcon-6c8dade6.js";import"./NewIcon-1fb8d883.js";import"./@tanstack/react-table-e9a5a890.js";import"./react-virtual-793d5da3.js";import"./@tanstack/match-sorter-utils-120d5a33.js";const T=({data:l,normalize:c,columns:e,accessor:s,label:d,readonly:u,renderDetail:n})=>{const[t,f]=o.useState(!1),[w,m]=A(r=>r[s]),x=(c==null?void 0:c(l))??w,g=o.useCallback(r=>{const i=l.filter(I=>I!==r);m({[s]:i})},[s,l,m]),F=o.useCallback(r=>{const i=[...new Set([...l,r])];m({[s]:i})},[s,l,m]),D=o.useMemo(()=>{const r=[...e];return u&&r.push({accessorKey:"actions",header:"",cell:({row:{original:i}})=>a("img",{src:W,alt:"",width:"18",height:"18",onClick:()=>g(i)})}),r},[e,g,u]);return p(y,{children:[p(P,{children:[a("legend",{children:p(y,{children:[d,u&&a("button",{type:"button",onClick:()=>f(!0),children:"Add"})]})}),a(G,{data:x,columns:D,useRadius:!0,showHeader:!1})]},`table-form-field-${s}`),t&&a(C,{children:a(y,{children:n==null?void 0:n(F,()=>f(!1))})})]})},ae=()=>{const{invoiceId:l}=Q(),c=R(),{data:e,isLoading:s}=K(l),d=o.useMemo(()=>[{accessorKey:"productNameWithCode",header:"Product"},{accessorKey:"date",header:"Date",cell:({row:{original:{date:t}}})=>a(S,{date:t})},{accessorKey:"description",header:"Description"},{accessorKey:"quantity",header:"Quantity",cell:({row:{original:{quantity:t}}})=>a(h,{value:t,output:"number"})},{accessorKey:"priceUnit",header:"Price Unit",cell:({row:{original:{priceUnit:t}}})=>a(h,{value:t,output:"currency"})},{accessorKey:"priceQuantity",header:"Price Quantity",cell:({row:{original:{priceQuantity:t}}})=>a(h,{value:t,output:"currency"})}],[]),u=o.useMemo(()=>[{type:"row",label:"General",fields:[{type:"group",label:"General",fields:[{type:"row",fields:[{accessor:"invoice",label:"Invoice",type:"text",value:e==null?void 0:e.invoice,readonly:!0},{accessor:"date",label:"Date",type:"text",value:e==null?void 0:e.date,readonly:!0,normalize:t=>k(t)}]},{accessor:"fullNameWithInitials",label:"Customer",type:"text",value:e==null?void 0:e.customer,readonly:!0}]},{type:"group",label:"Amounts",fields:[{type:"object",label:"Amounts",accessor:"",render:()=>a(j,{})}]},{type:"rule",accessor:"taxesPercentage",value:e==null?void 0:e.taxesPercentage},{accessor:"subtotal",type:"rule",value:e==null?void 0:e.subtotal,normalize:t=>b(t,"currency")},{accessor:"taxes",type:"rule",value:e==null?void 0:e.taxes,normalize:t=>b(t,"currency")},{accessor:"total",type:"rule",value:e==null?void 0:e.total,normalize:t=>b(t,"currency")}]},{type:"row",fields:[{accessor:"details",label:"details",type:"table",render:()=>a(T,{accessor:"details",label:"Details",columns:d,data:e==null?void 0:e.details,showHeader:!1}),readonly:!0}]}],[d,e==null?void 0:e.customer,e==null?void 0:e.date,e==null?void 0:e.invoice,e==null?void 0:e.details,e==null?void 0:e.subtotal,e==null?void 0:e.taxes,e==null?void 0:e.taxesPercentage,e==null?void 0:e.total]),n=o.useCallback(()=>c("/invoices"),[c]);return s||!u?a(L,{}):a(N,{initialFields:u,initialData:e,children:a(M,{icon:a(H,{}),title:"View invoice",actions:a(V,{invoice:e}),onFinish:n,height:"612px",width:"1120px"})})};export{ae as default};
